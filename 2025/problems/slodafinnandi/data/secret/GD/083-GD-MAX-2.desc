Edge case n = 10^18.
